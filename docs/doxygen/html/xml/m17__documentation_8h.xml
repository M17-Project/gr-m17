<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="m17__documentation_8h" kind="file" language="C++">
    <compoundname>m17_documentation.h</compoundname>
    <briefdescription>
<para>M17 Digital Voice Protocol Documentation. </para>
    </briefdescription>
    <detaileddescription>
<para>This file contains comprehensive Doxygen documentation for the M17 digital voice protocol implementation, including security considerations, usage examples, and compatibility information.</para>
<para><simplesect kind="author"><para>M17 Development Team </para>
</simplesect>
<simplesect kind="version"><para>1.0 </para>
</simplesect>
<simplesect kind="date"><para>2024</para>
</simplesect>
</para>
<sect1 id="m17__documentation_8h_1overview">
<title>Overview</title>
<para>The M17 Digital Voice Protocol is a digital voice protocol designed for amateur radio use. This implementation provides comprehensive security features including hardware security module (HSM) support, cryptographic authentication, and compatibility modes.</para>
</sect1>
<sect1 id="m17__documentation_8h_1security">
<title>Security Features</title>
<para>The M17 implementation includes several critical security features:</para>
<sect2 id="m17__documentation_8h_1crypto">
<title>Cryptographic Security</title>
<para><itemizedlist>
<listitem><para><bold>Ed25519 Digital Signatures</bold>: Modern elliptic curve digital signatures</para>
</listitem><listitem><para><bold>Curve25519 ECDH</bold>: Secure key agreement for encrypted channels</para>
</listitem><listitem><para><bold>P-256 ECDSA</bold>: M17 specification compliant signatures</para>
</listitem><listitem><para><bold>AES-256-GCM</bold>: Authenticated encryption for extended mode</para>
</listitem><listitem><para><bold>AES-256-CTR</bold>: M17 specification compliant encryption</para>
</listitem><listitem><para><bold>HKDF</bold>: Secure key derivation from shared secrets</para>
</listitem><listitem><para><bold>SHA-256</bold>: Cryptographic hashing for signatures</para>
</listitem></itemizedlist>
</para>
</sect2>
<sect2 id="m17__documentation_8h_1memory">
<title>Memory Security</title>
<para><itemizedlist>
<listitem><para><bold>Secure Memory Clearing</bold>: Uses explicit_bzero for sensitive data</para>
</listitem><listitem><para><bold>Memory Protection</bold>: Bounds checking and overflow protection</para>
</listitem><listitem><para><bold>Secure Random Number Generation</bold>: Uses /dev/urandom and /dev/hwrng</para>
</listitem><listitem><para><bold>Key Management</bold>: Hardware security module integration</para>
</listitem></itemizedlist>
</para>
</sect2>
<sect2 id="m17__documentation_8h_1authentication">
<title>Authentication</title>
<para><itemizedlist>
<listitem><para><bold>Digital Signatures</bold>: Ed25519 and P-256 ECDSA support</para>
</listitem><listitem><para><bold>Challenge-Response</bold>: Secure authentication protocols</para>
</listitem><listitem><para><bold>Replay Protection</bold>: Timestamp and nonce validation</para>
</listitem><listitem><para><bold>Hardware Security</bold>: Nitrokey HSM integration</para>
</listitem></itemizedlist>
</para>
</sect2>
</sect1>
<sect1 id="m17__documentation_8h_1compatibility">
<title>Compatibility Modes</title>
<para>The M17 implementation supports two compatibility modes:</para>
<sect2 id="m17__documentation_8h_1strict_mode">
<title>M17 Strict Mode (Default)</title>
<para>Full M17 specification compliance:<itemizedlist>
<listitem><para>P-256 ECDSA for digital signatures</para>
</listitem><listitem><para>AES-256-CTR for encryption</para>
</listitem><listitem><para>Standard LSF/META field usage</para>
</listitem><listitem><para>Compatible with all M17 implementations</para>
</listitem></itemizedlist>
</para>
</sect2>
<sect2 id="m17__documentation_8h_1extended_mode">
<title>Extended Mode (Nitrokey)</title>
<para>Enhanced features with hardware security:<itemizedlist>
<listitem><para>Ed25519 digital signatures</para>
</listitem><listitem><para>Curve25519 ECDH key agreement</para>
</listitem><listitem><para>AES-256-GCM authenticated encryption</para>
</listitem><listitem><para>Nitrokey HSM integration</para>
</listitem><listitem><para>Challenge-response authentication</para>
</listitem></itemizedlist>
</para>
<para><simplesect kind="warning"><para>SECURITY WARNING: Extended mode is NOT M17 spec compliant </para>
</simplesect>
<simplesect kind="warning"><para>SECURITY WARNING: Extended mode requires coordination with other stations </para>
</simplesect>
<simplesect kind="note"><para>Use strict mode for maximum compatibility </para>
</simplesect>
<simplesect kind="note"><para>Extended mode is for advanced users with Nitrokey hardware</para>
</simplesect>
</para>
</sect2>
</sect1>
<sect1 id="m17__documentation_8h_1usage">
<title>Usage Examples</title>
<sect2 id="m17__documentation_8h_1basic_usage">
<title>Basic Usage</title>
<para><programlisting><codeline><highlight class="comment">//<sp/>Create<sp/>decoder<sp/>with<sp/>default<sp/>settings<sp/>(strict<sp/>mode)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">m17_decoder_impl<sp/>decoder(</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">//<sp/>debug_data</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">//<sp/>debug_ctrl</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>0.9,<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>threshold</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>callsign<sp/>display</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/><sp/></highlight><highlight class="comment">//<sp/>signed_str</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>0,<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ENCR_NONE</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>key<sp/>(set<sp/>later)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>seed<sp/>(set<sp/>later)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>encryption<sp/>key<sp/>(32<sp/>bytes<sp/>=<sp/>64<sp/>hex<sp/>characters)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">decoder.set_key(</highlight><highlight class="stringliteral">&quot;0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Enable<sp/>strict<sp/>M17<sp/>mode<sp/>(default)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">decoder.set_m17_strict_mode(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="m17__documentation_8h_1extended_usage">
<title>Extended Mode Usage</title>
<para><programlisting><codeline><highlight class="comment">//<sp/>Enable<sp/>extended<sp/>crypto<sp/>mode<sp/>(requires<sp/>Nitrokey)</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">decoder.set_extended_crypto(</highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>Ed25519<sp/>keys<sp/>for<sp/>digital<sp/>signatures</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>ed25519_pub[32],<sp/>ed25519_priv[32];</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>...<sp/>load<sp/>keys<sp/>from<sp/>secure<sp/>storage<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">decoder.set_ed25519_keys(ed25519_pub,<sp/>32,<sp/>ed25519_priv,<sp/>32);</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>Set<sp/>Curve25519<sp/>keys<sp/>for<sp/>ECDH</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">uint8_t<sp/>curve25519_pub[32],<sp/>curve25519_priv[32];</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="comment">//<sp/>...<sp/>load<sp/>keys<sp/>from<sp/>secure<sp/>storage<sp/>...</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">decoder.set_curve25519_keys(curve25519_pub,<sp/>32,<sp/>curve25519_priv,<sp/>32);</highlight></codeline>
</programlisting></para>
</sect2>
<sect2 id="m17__documentation_8h_1nitrokey_usage">
<title>Nitrokey Integration</title>
<para><programlisting><codeline><highlight class="comment">//<sp/>Initialize<sp/>Nitrokey<sp/>hardware<sp/>security<sp/>module</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(decoder.init_nitrokey_security(</highlight><highlight class="stringliteral">&quot;123456&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Use<sp/>hardware-backed<sp/>cryptography</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decoder.sign_with_hardware(data,<sp/>len,<sp/>signature,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>decoder.ecdh_with_hardware(peer_pubkey,<sp/>shared_secret,<sp/>0);</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting></para>
</sect2>
</sect1>
<sect1 id="m17__documentation_8h_1security_warnings">
<title>Security Warnings</title>
<para><simplesect kind="warning"><para>SECURITY CRITICAL: Never log cryptographic keys, private keys, or seeds </para>
</simplesect>
<simplesect kind="warning"><para>SECURITY CRITICAL: Always use secure memory clearing for sensitive data </para>
</simplesect>
<simplesect kind="warning"><para>SECURITY CRITICAL: Validate all cryptographic operations return codes </para>
</simplesect>
<simplesect kind="warning"><para>SECURITY CRITICAL: Use hardware security modules for production systems </para>
</simplesect>
<simplesect kind="warning"><para>SECURITY CRITICAL: Never use weak random number generators </para>
</simplesect>
<simplesect kind="warning"><para>SECURITY CRITICAL: Always validate input parameters</para>
</simplesect>
</para>
</sect1>
<sect1 id="m17__documentation_8h_1best_practices">
<title>Best Practices</title>
<sect2 id="m17__documentation_8h_1key_management">
<title>Key Management</title>
<para><itemizedlist>
<listitem><para>Store private keys in hardware security modules</para>
</listitem><listitem><para>Use secure key derivation functions</para>
</listitem><listitem><para>Implement proper key rotation</para>
</listitem><listitem><para>Clear sensitive memory after use</para>
</listitem></itemizedlist>
</para>
</sect2>
<sect2 id="m17__documentation_8h_1authentication">
<title>Authentication</title>
<para><itemizedlist>
<listitem><para>Use digital signatures for message authentication</para>
</listitem><listitem><para>Implement challenge-response protocols</para>
</listitem><listitem><para>Validate timestamps and nonces</para>
</listitem><listitem><para>Protect against replay attacks</para>
</listitem></itemizedlist>
</para>
</sect2>
<sect2 id="m17__documentation_8h_1encryption">
<title>Encryption</title>
<para><itemizedlist>
<listitem><para>Use authenticated encryption (AES-GCM)</para>
</listitem><listitem><para>Generate random IVs for each message</para>
</listitem><listitem><para>Use secure key agreement (ECDH)</para>
</listitem><listitem><para>Implement proper key derivation</para>
</listitem></itemizedlist>
</para>
</sect2>
</sect1>
<sect1 id="m17__documentation_8h_1troubleshooting">
<title>Troubleshooting</title>
<sect2 id="m17__documentation_8h_1common_issues">
<title>Common Issues</title>
<para><itemizedlist>
<listitem><para><bold>Invalid key format</bold>: Ensure keys are hex-encoded (64 characters for 32 bytes)</para>
</listitem><listitem><para><bold>Compatibility issues</bold>: Use strict mode for maximum compatibility</para>
</listitem><listitem><para><bold>Security warnings</bold>: Review all security warnings and fix issues</para>
</listitem><listitem><para><bold>Hardware issues</bold>: Ensure Nitrokey is properly connected and initialized</para>
</listitem></itemizedlist>
</para>
</sect2>
<sect2 id="m17__documentation_8h_1debugging">
<title>Debugging</title>
<para><itemizedlist>
<listitem><para>Enable debug output for troubleshooting</para>
</listitem><listitem><para>Check cryptographic operation return codes</para>
</listitem><listitem><para>Validate input parameters</para>
</listitem><listitem><para>Review security audit reports</para>
</listitem></itemizedlist>
</para>
</sect2>
</sect1>
<sect1 id="m17__documentation_8h_1references">
<title>References</title>
<para><itemizedlist>
<listitem><para>M17 Digital Voice Protocol Specification</para>
</listitem><listitem><para>GNU Radio Documentation</para>
</listitem><listitem><para>OpenSSL Documentation</para>
</listitem><listitem><para>Nitrokey Documentation</para>
</listitem><listitem><para>Security Best Practices Guide</para>
</listitem></itemizedlist>
</para>
</sect1>
<sect1 id="m17__documentation_8h_1changelog">
<title>Changelog</title>
<para><simplesect kind="version"><para>1.0<itemizedlist>
<listitem><para>Initial implementation with basic M17 support</para>
</listitem><listitem><para>Added security features and hardware integration</para>
</listitem><listitem><para>Implemented compatibility modes</para>
</listitem><listitem><para>Added comprehensive documentation </para>
</listitem></itemizedlist>
</para>
</simplesect>
</para>
</sect1>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
    </programlisting>
    <location file="m17_documentation.h"/>
  </compounddef>
</doxygen>
